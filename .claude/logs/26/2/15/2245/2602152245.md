# 작업 로그: 개별종목-테마 연결 + 테마 상세 조회 + 종목 테마 필터

- **프롬프트**: `.claude/prompts/26/2/15/2245.md`
- **작업일시**: 2026-02-15

---

## Task 1: 개별종목-테마 ManyToMany 연결 기능

### 신규 파일
| 파일 | 설명 |
|------|------|
| `src/main/resources/sql/create_stock_themes_table.sql` | stock_themes 조인 테이블 DDL |
| `src/main/java/.../adapter/webapi/dto/request/AddStockThemeRequest.kt` | 요청 DTO |
| `src/main/java/.../application/required/StockThemeAdder.kt` | 추가 인터페이스 |
| `src/main/java/.../application/required/StockThemeRemover.kt` | 제거 인터페이스 |
| `src/main/java/.../application/stock/command/CommandStockThemeAdder.kt` | 추가 서비스 |
| `src/main/java/.../application/stock/command/CommandStockThemeRemover.kt` | 제거 서비스 |
| `src/main/java/.../adapter/webapi/AddStockThemeApi.kt` | POST /api/stocks/{stockId}/themes |
| `src/main/java/.../adapter/webapi/RemoveStockThemeApi.kt` | DELETE /api/stocks/{stockId}/themes/{themeId} |

### 수정 파일
| 파일 | 변경 내용 |
|------|-----------|
| `domain/stock/Stock.kt` | `@ManyToMany` themes 관계 추가 |
| `application/provided/StockRepository.kt` | `findByIdWithThemes`, `findByStockCodeWithThemes`, `findByThemeId` 쿼리 추가, `findWithFilters`에 themeName 파라미터 추가 |
| `adapter/webapi/dto/response/StockResponse.kt` | `themes: List<ThemeResponse>` 필드 추가 |
| `application/stock/query/QueryStockFinder.kt` | themes 매핑 추가, `findByIdWithThemes`/`findByStockCodeWithThemes` 사용 |

---

## Task 2: 테마 상세 조회 (연결된 뉴스/종목 포함)

### 신규 파일
| 파일 | 설명 |
|------|------|
| `adapter/webapi/dto/response/ThemeDetailResponse.kt` | 테마 + 뉴스목록 + 종목목록 응답 DTO |
| `application/required/ThemeFinder.kt` | 테마 상세 조회 인터페이스 |
| `application/theme/query/QueryThemeFinder.kt` | 테마 + 관련 뉴스/종목 조회 서비스 |
| `adapter/webapi/GetThemeDetailApi.kt` | GET /api/themes/{id} |

### 수정 파일
| 파일 | 변경 내용 |
|------|-----------|
| `application/provided/NewsRepository.kt` | `findByThemeId(themeId)` 쿼리 추가 |

---

## Task 3: 개별종목 목록에 테마 필터 추가

### 수정 파일
| 파일 | 변경 내용 |
|------|-----------|
| `adapter/webapi/GetStockListApi.kt` | `themeName` 파라미터 추가 |
| `application/required/StockLister.kt` | `themeName` 파라미터 추가 |
| `application/stock/query/QueryStockLister.kt` | `themeName` 전달 + themes 매핑 추가 |

---

## API 문서 업데이트
| 파일 | 변경 내용 |
|------|-----------|
| `api_documents/stock.md` | 테마 추가/제거 API, themes 필드, themeName 필터 문서화 |
| `api_documents/theme.md` | GET /api/themes/{id} 상세 조회 API 문서화 |
